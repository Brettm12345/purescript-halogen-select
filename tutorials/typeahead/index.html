



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Building blocks for common selection user interfaces in PureScript & Halogen">
      
      
        <link rel="canonical" href="https://citizennet.github.io/purescript-halogen-select/tutorials/typeahead/">
      
      
        <meta name="author" content="Thomas Honeyman">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>Build a typeahead - Select Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/cn-tailwind.scoped.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="cyan" data-md-color-accent="cyan">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#lets-build-a-typeahead" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://citizennet.github.io/purescript-halogen-select" title="Select Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Select Documentation
              </span>
              <span class="md-header-nav__topic">
                Build a typeahead
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/citizennet/purescript-halogen-select/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      purescript-halogen-select
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </span>
    Select Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/citizennet/purescript-halogen-select/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      purescript-halogen-select
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-started/" title="Project setup" class="md-nav__link">
      Project setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dropdown/" title="Build a dropdown" class="md-nav__link">
      Build a dropdown
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Build a typeahead
      </label>
    
    <a href="./" title="Build a typeahead" class="md-nav__link md-nav__link--active">
      Build a typeahead
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#conclusion" title="Conclusion" class="md-nav__link">
    Conclusion
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#next-steps" title="Next Steps" class="md-nav__link">
    Next Steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-code" title="Source Code" class="md-nav__link">
    Source Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      How To
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        How To
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/embed-parent-queries/" title="How to embed parent queries" class="md-nav__link">
      How to embed parent queries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Concepts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Concepts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/understanding-free-queries/" title="Understanding free queries" class="md-nav__link">
      Understanding free queries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#conclusion" title="Conclusion" class="md-nav__link">
    Conclusion
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#next-steps" title="Next Steps" class="md-nav__link">
    Next Steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-code" title="Source Code" class="md-nav__link">
    Source Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/citizennet/purescript-halogen-select/edit/master/docs/tutorials/typeahead.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="lets-build-a-typeahead">Let's build a typeahead!<a class="headerlink" href="#lets-build-a-typeahead" title="Permanent link">&para;</a></h1>
<p>Typeaheads are among the most common selection components you'll build. Most web developers have had to implement at least one of these before and they can be surprisingly difficult to build. Luckily, with <code>Select</code>, implementing a typeahead that fits your custom design takes little more than writing the rendering code and then tweaking it with a helper function or two.</p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<h3 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h3>
<p>Now that you're able to build a typeahead with <code>Select</code> you know everything you need to build more complex components like date pickers and image pickers. The next tutorial in the series, <em>Let's build a date picker</em>, is currently a work in progress.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Did you notice anything you would improve about this tutorial or the <code>Select</code> library? I'd love to hear about it! Feel free to reach out on the <a href="https://functionalprogramming.slack.com/">functional programming Slack</a> or on the <a href="https://purescript-users.ml">PureScript user forum</a>. If you found a bug or would like to make an improvement, please open an issue or pull request on the library.</p>
</div>
<h3 id="source-code">Source Code<a class="headerlink" href="#source-code" title="Permanent link">&para;</a></h3>
<p>If you'd like to use this component as a starting point from which to build your own, feel free to copy/paste the source code below.</p>
<details class="article"><summary>Full source code for the tutorial</summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">module</span> <span class="nn">Component</span> <span class="kr">where</span>

<span class="kr">import</span> <span class="nn">Prelude</span>

<span class="kr">import</span> <span class="nn">Control.Monad.Aff</span> <span class="p">(</span><span class="kt">Aff</span><span class="p">,</span> <span class="kt">Milliseconds</span><span class="p">(</span><span class="o">..</span><span class="p">))</span>
<span class="kr">import</span> <span class="nn">Control.Monad.Aff.AVar</span> <span class="p">(</span><span class="kt">AVAR</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Control.Monad.Aff.Class</span> <span class="p">(</span><span class="nf">class</span> <span class="kt">MonadAff</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Control.Monad.Aff.Console</span> <span class="p">(</span><span class="kt">CONSOLE</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">DOM</span> <span class="p">(</span><span class="kt">DOM</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Argonaut</span> <span class="p">(</span><span class="kt">Json</span><span class="p">,</span> <span class="nf">decodeJson</span><span class="p">,</span> <span class="p">(</span><span class="o">.?</span><span class="p">))</span>
<span class="kr">import</span> <span class="nn">Data.Array</span> <span class="p">(</span><span class="nf">difference</span><span class="p">,</span> <span class="nf">filter</span><span class="p">,</span> <span class="nf">length</span><span class="p">,</span> <span class="nf">mapWithIndex</span><span class="p">,</span> <span class="p">(</span><span class="o">:</span><span class="p">))</span>
<span class="kr">import</span> <span class="nn">Data.Either</span> <span class="p">(</span><span class="kt">Either</span><span class="p">(</span><span class="o">..</span><span class="p">))</span>
<span class="kr">import</span> <span class="nn">Data.Maybe</span> <span class="p">(</span><span class="kt">Maybe</span><span class="p">(</span><span class="o">..</span><span class="p">))</span>
<span class="kr">import</span> <span class="nn">Data.String</span> <span class="p">(</span><span class="kt">Pattern</span><span class="p">(</span><span class="o">..</span><span class="p">),</span> <span class="nf">contains</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Traversable</span> <span class="p">(</span><span class="nf">traverse</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Halogen</span> <span class="k">as</span> <span class="n">H</span>
<span class="kr">import</span> <span class="nn">Halogen.HTML</span> <span class="k">as</span> <span class="n">HH</span>
<span class="kr">import</span> <span class="nn">Halogen.HTML.Events</span> <span class="k">as</span> <span class="n">HE</span>
<span class="kr">import</span> <span class="nn">Halogen.HTML.Properties</span> <span class="k">as</span> <span class="n">HP</span>
<span class="kr">import</span> <span class="nn">Network.HTTP.Affjax</span> <span class="p">(</span><span class="kt">AJAX</span><span class="p">,</span> <span class="nf">get</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Network.RemoteData</span> <span class="p">(</span><span class="kt">RemoteData</span><span class="p">(</span><span class="o">..</span><span class="p">),</span> <span class="nf">withDefault</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Select</span> <span class="k">as</span> <span class="n">Select</span>
<span class="kr">import</span> <span class="nn">Select.Utils.Setters</span> <span class="k">as</span> <span class="n">Setters</span>

<span class="kr">data</span> <span class="kt">Query</span> <span class="n">a</span>
  <span class="ow">=</span> <span class="kt">HandleSelect</span> <span class="p">(</span><span class="kt">Select</span><span class="o">.</span><span class="kt">Message</span> <span class="kt">Query</span> <span class="kt">String</span><span class="p">)</span> <span class="n">a</span>
  <span class="o">|</span> <span class="kt">Remove</span> <span class="kt">String</span> <span class="n">a</span>

<span class="kr">type</span> <span class="kt">State</span> <span class="n">eff</span> <span class="ow">=</span>
  <span class="p">{</span> <span class="n">items</span> <span class="ow">::</span> <span class="kt">RemoteData</span> <span class="kt">String</span> <span class="p">(</span><span class="kt">Array</span> <span class="kt">String</span><span class="p">)</span>
  <span class="p">,</span> <span class="n">selections</span> <span class="ow">::</span> <span class="kt">Array</span> <span class="kt">String</span>
  <span class="p">,</span> <span class="n">debounceTime</span> <span class="ow">::</span> <span class="kt">Milliseconds</span>
  <span class="p">,</span> <span class="n">fetchItems</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">Aff</span> <span class="n">eff</span> <span class="p">(</span><span class="kt">RemoteData</span> <span class="kt">String</span> <span class="p">(</span><span class="kt">Array</span> <span class="kt">String</span><span class="p">))</span>
  <span class="p">}</span>

<span class="kr">type</span> <span class="kt">Input</span> <span class="ow">=</span> <span class="kt">Unit</span>

<span class="kr">data</span> <span class="kt">Message</span>
  <span class="ow">=</span> <span class="kt">SelectionChange</span> <span class="p">(</span><span class="kt">Array</span> <span class="kt">String</span><span class="p">)</span>

<span class="kr">type</span> <span class="kt">ChildSlot</span> <span class="ow">=</span> <span class="kt">Unit</span>
<span class="kr">type</span> <span class="kt">ChildQuery</span> <span class="n">eff</span> <span class="ow">=</span> <span class="kt">Select</span><span class="o">.</span><span class="kt">Query</span> <span class="kt">Query</span> <span class="kt">String</span> <span class="n">eff</span>

<span class="kr">type</span> <span class="kt">Effects</span> <span class="n">eff</span> <span class="ow">=</span>
  <span class="p">(</span> <span class="n">dom</span> <span class="ow">::</span> <span class="kt">DOM</span>
  <span class="p">,</span> <span class="n">avar</span> <span class="ow">::</span> <span class="kt">AVAR</span>
  <span class="p">,</span> <span class="n">ajax</span> <span class="ow">::</span> <span class="kt">AJAX</span>
  <span class="p">,</span> <span class="n">console</span> <span class="ow">::</span> <span class="kt">CONSOLE</span>
  <span class="o">|</span> <span class="n">eff</span>
  <span class="p">)</span>

<span class="nf">component</span> <span class="ow">::</span> <span class="err">∀</span> <span class="n">eff</span> <span class="n">m</span>
  <span class="o">.</span> <span class="kt">MonadAff</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">)</span> <span class="n">m</span>
 <span class="ow">=&gt;</span> <span class="kt">H</span><span class="o">.</span><span class="kt">Component</span> <span class="kt">HH</span><span class="o">.</span><span class="kt">HTML</span> <span class="kt">Query</span> <span class="kt">Input</span> <span class="kt">Message</span> <span class="n">m</span>
<span class="nf">component</span> <span class="ow">=</span>
  <span class="kt">H</span><span class="o">.</span><span class="n">parentComponent</span>
    <span class="p">{</span> <span class="n">initialState</span>
    <span class="p">,</span> <span class="n">render</span>
    <span class="p">,</span> <span class="n">eval</span>
    <span class="p">,</span> <span class="n">receiver</span><span class="kt">:</span> <span class="n">const</span> <span class="kt">Nothing</span>
    <span class="p">}</span>
  <span class="kr">where</span>

  <span class="n">initialState</span> <span class="ow">::</span> <span class="kt">Input</span> <span class="ow">-&gt;</span> <span class="kt">State</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">)</span>
  <span class="n">initialState</span> <span class="ow">=</span> <span class="n">const</span>
    <span class="p">{</span> <span class="n">items</span><span class="kt">:</span> <span class="kt">NotAsked</span>
    <span class="p">,</span> <span class="n">selections</span><span class="kt">:</span> <span class="kt">[]</span>
    <span class="p">,</span> <span class="n">debounceTime</span><span class="kt">:</span> <span class="kt">Milliseconds</span> <span class="mf">100.0</span>
    <span class="p">,</span> <span class="n">fetchItems</span>
    <span class="p">}</span>

  <span class="n">fetchItems</span>
    <span class="ow">::</span> <span class="kt">String</span>
    <span class="ow">-&gt;</span> <span class="kt">Aff</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">)</span> <span class="p">(</span><span class="kt">RemoteData</span> <span class="kt">String</span> <span class="p">(</span><span class="kt">Array</span> <span class="kt">String</span><span class="p">))</span>
  <span class="n">fetchItems</span> <span class="n">str</span> <span class="ow">=</span> <span class="kr">do</span>
     <span class="p">(</span><span class="n">res</span> <span class="ow">::</span> <span class="kt">Json</span><span class="p">)</span> <span class="ow">&lt;-</span> <span class="kr">_</span><span class="o">.</span><span class="n">response</span>
       <span class="o">&lt;$&gt;</span> <span class="n">get</span> <span class="p">(</span><span class="s">&quot;https://swapi.co/api/people/?search=&quot;</span> <span class="o">&lt;&gt;</span> <span class="n">str</span><span class="p">)</span>

     <span class="kr">let</span> <span class="n">items</span> <span class="ow">=</span> <span class="kr">do</span>
           <span class="n">obj</span> <span class="ow">&lt;-</span> <span class="n">decodeJson</span> <span class="n">res</span>
           <span class="n">arr</span> <span class="ow">&lt;-</span> <span class="n">obj</span> <span class="o">.?</span> <span class="s">&quot;results&quot;</span>
           <span class="n">traverse</span> <span class="p">(</span><span class="n">decodeJson</span> <span class="o">&lt;=&lt;</span> <span class="n">flip</span> <span class="p">(</span><span class="o">.?</span><span class="p">)</span> <span class="s">&quot;name&quot;</span><span class="p">)</span> <span class="n">arr</span>

     <span class="n">pure</span> <span class="o">$</span> <span class="kr">case</span> <span class="n">items</span> <span class="kr">of</span>
       <span class="kt">Left</span> <span class="n">err</span> <span class="ow">-&gt;</span> <span class="kt">Failure</span> <span class="o">$</span> <span class="s">&quot;Could not fetch data:</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">&lt;&gt;</span> <span class="n">err</span>
       <span class="kt">Right</span> <span class="n">xs</span> <span class="ow">-&gt;</span> <span class="kt">Success</span> <span class="n">xs</span>

  <span class="n">render</span>
    <span class="ow">::</span> <span class="kt">State</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">)</span>
    <span class="ow">-&gt;</span> <span class="kt">H</span><span class="o">.</span><span class="kt">ParentHTML</span> <span class="kt">Query</span> <span class="p">(</span><span class="kt">ChildQuery</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">))</span> <span class="kt">ChildSlot</span> <span class="n">m</span>
  <span class="n">render</span> <span class="n">parentState</span> <span class="ow">=</span>
    <span class="kt">HH</span><span class="o">.</span><span class="n">div_</span>
    <span class="p">[</span> <span class="kt">HH</span><span class="o">.</span><span class="n">h1_</span>
      <span class="p">[</span> <span class="kt">HH</span><span class="o">.</span><span class="n">text</span> <span class="s">&quot;Typeahead&quot;</span> <span class="p">]</span>
    <span class="p">,</span> <span class="kt">HH</span><span class="o">.</span><span class="n">slot</span> <span class="n">unit</span> <span class="kt">Select</span><span class="o">.</span><span class="n">component</span> <span class="n">selectInput</span> <span class="p">(</span><span class="kt">HE</span><span class="o">.</span><span class="n">input</span> <span class="kt">HandleSelect</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="kr">where</span>
      <span class="n">selectInput</span> <span class="ow">::</span> <span class="kt">Select</span><span class="o">.</span><span class="kt">Input</span> <span class="kt">Query</span> <span class="kt">String</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">)</span>
      <span class="n">selectInput</span> <span class="ow">=</span>
        <span class="p">{</span> <span class="n">inputType</span><span class="kt">:</span> <span class="kt">Select</span><span class="o">.</span><span class="kt">TextInput</span>
        <span class="p">,</span> <span class="n">items</span><span class="kt">:</span> <span class="n">withDefault</span> <span class="kt">[]</span> <span class="n">parentState</span><span class="o">.</span><span class="n">items</span>
        <span class="p">,</span> <span class="n">initialSearch</span><span class="kt">:</span> <span class="kt">Nothing</span>
        <span class="p">,</span> <span class="n">debounceTime</span><span class="kt">:</span> <span class="kt">Just</span> <span class="n">parentState</span><span class="o">.</span><span class="n">debounceTime</span>
        <span class="p">,</span> <span class="n">render</span><span class="kt">:</span> <span class="n">typeahead</span>
        <span class="p">}</span>

      <span class="n">typeahead</span>
        <span class="ow">::</span> <span class="kt">Select</span><span class="o">.</span><span class="kt">State</span> <span class="kt">String</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">)</span>
        <span class="ow">-&gt;</span> <span class="kt">Select</span><span class="o">.</span><span class="kt">ComponentHTML</span> <span class="kt">Query</span> <span class="kt">String</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">)</span>
      <span class="n">typeahead</span> <span class="n">childState</span> <span class="ow">=</span>
        <span class="kt">HH</span><span class="o">.</span><span class="n">div_</span>
        <span class="p">[</span> <span class="kt">HH</span><span class="o">.</span><span class="n">ul_</span>
          <span class="p">(</span> <span class="n">parentState</span><span class="o">.</span><span class="n">selections</span> <span class="o">&lt;#&gt;</span>
            <span class="p">(</span><span class="nf">\</span><span class="n">item</span> <span class="ow">-&gt;</span>
                <span class="kt">HH</span><span class="o">.</span><span class="n">li</span>
                <span class="p">[</span> <span class="kt">HE</span><span class="o">.</span><span class="n">onClick</span> <span class="o">$</span> <span class="kt">Select</span><span class="o">.</span><span class="n">always</span> <span class="o">$</span> <span class="kt">Select</span><span class="o">.</span><span class="n">raise</span> <span class="o">$</span> <span class="kt">Remove</span> <span class="n">item</span> <span class="n">unit</span> <span class="p">]</span>
                <span class="p">[</span> <span class="kt">HH</span><span class="o">.</span><span class="n">text</span> <span class="n">item</span> <span class="p">]</span>
            <span class="p">)</span>
          <span class="p">)</span>
        <span class="p">,</span> <span class="kt">HH</span><span class="o">.</span><span class="n">input</span>
          <span class="p">(</span> <span class="kt">Setters</span><span class="o">.</span><span class="n">setInputProps</span> <span class="kt">[]</span> <span class="p">)</span>
        <span class="p">,</span> <span class="kr">case</span> <span class="n">childState</span><span class="o">.</span><span class="n">visibility</span> <span class="kr">of</span>
            <span class="kt">Select</span><span class="o">.</span><span class="kt">Off</span> <span class="ow">-&gt;</span> <span class="kt">HH</span><span class="o">.</span><span class="n">text</span> <span class="s">&quot;&quot;</span>
            <span class="kt">Select</span><span class="o">.</span><span class="kt">On</span> <span class="ow">-&gt;</span> <span class="kt">HH</span><span class="o">.</span><span class="n">ul</span> <span class="p">(</span><span class="kt">Setters</span><span class="o">.</span><span class="n">setContainerProps</span> <span class="kt">[]</span><span class="p">)</span> <span class="o">$</span>
              <span class="kr">case</span> <span class="n">length</span> <span class="n">childState</span><span class="o">.</span><span class="n">items</span> <span class="kr">of</span>
                <span class="mi">0</span> <span class="ow">-&gt;</span>
                  <span class="p">[</span> <span class="kt">HH</span><span class="o">.</span><span class="n">li</span>
                    <span class="p">[</span> <span class="kt">HE</span><span class="o">.</span><span class="n">onClick</span>
                      <span class="o">$</span> <span class="kt">Select</span><span class="o">.</span><span class="n">always</span>
                      <span class="o">$</span> <span class="kt">Select</span><span class="o">.</span><span class="n">raise</span>
                      <span class="o">$</span> <span class="kt">HandleSelect</span> <span class="p">(</span><span class="kt">Select</span><span class="o">.</span><span class="kt">Searched</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="n">unit</span> <span class="p">]</span>
                    <span class="p">[</span> <span class="kt">HH</span><span class="o">.</span><span class="n">text</span> <span class="s">&quot;Fetch new data&quot;</span> <span class="p">]</span>
                  <span class="p">]</span>
                <span class="kr">_</span> <span class="ow">-&gt;</span> <span class="kt">[]</span>
              <span class="o">&lt;&gt;</span>
              <span class="p">(</span> <span class="n">mapWithIndex</span>
                <span class="p">(</span><span class="nf">\</span><span class="n">ix</span> <span class="n">item</span> <span class="ow">-&gt;</span>
                  <span class="kt">HH</span><span class="o">.</span><span class="n">li</span>
                    <span class="p">(</span> <span class="kt">Setters</span><span class="o">.</span><span class="n">setItemProps</span> <span class="n">ix</span>
                      <span class="o">$</span> <span class="kr">case</span> <span class="kt">Just</span> <span class="n">ix</span> <span class="o">==</span> <span class="n">childState</span><span class="o">.</span><span class="n">highlightedIndex</span> <span class="kr">of</span>
                          <span class="n">true</span> <span class="ow">-&gt;</span> <span class="p">[</span> <span class="kt">HP</span><span class="o">.</span><span class="n">attr</span> <span class="p">(</span><span class="kt">HH</span><span class="o">.</span><span class="kt">AttrName</span> <span class="s">&quot;style&quot;</span><span class="p">)</span> <span class="s">&quot;color: red;&quot;</span> <span class="p">]</span>
                          <span class="kr">_</span> <span class="ow">-&gt;</span> <span class="kt">[]</span> <span class="p">)</span>
                    <span class="p">[</span> <span class="kt">HH</span><span class="o">.</span><span class="n">text</span> <span class="n">item</span> <span class="p">]</span>
                <span class="p">)</span>
                <span class="n">childState</span><span class="o">.</span><span class="n">items</span>
              <span class="p">)</span>
        <span class="p">]</span>

  <span class="n">eval</span>
    <span class="ow">::</span> <span class="kt">Query</span>
    <span class="o">~&gt;</span> <span class="kt">H</span><span class="o">.</span><span class="kt">ParentDSL</span> <span class="p">(</span><span class="kt">State</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">))</span> <span class="kt">Query</span> <span class="p">(</span><span class="kt">ChildQuery</span> <span class="p">(</span><span class="kt">Effects</span> <span class="n">eff</span><span class="p">))</span> <span class="kt">ChildSlot</span> <span class="kt">Message</span> <span class="n">m</span>
  <span class="n">eval</span> <span class="ow">=</span> <span class="kr">case</span> <span class="kr">_</span> <span class="kr">of</span>
    <span class="kt">Remove</span> <span class="n">item</span> <span class="n">next</span> <span class="ow">-&gt;</span> <span class="kr">do</span>
       <span class="kt">H</span><span class="o">.</span><span class="n">modify</span> <span class="nf">\</span><span class="n">st</span> <span class="ow">-&gt;</span> <span class="n">st</span> <span class="p">{</span> <span class="n">selections</span> <span class="ow">=</span> <span class="n">filter</span> <span class="p">(</span><span class="kr">_</span> <span class="o">/=</span> <span class="n">item</span><span class="p">)</span> <span class="n">st</span><span class="o">.</span><span class="n">selections</span> <span class="p">}</span>
       <span class="n">st</span> <span class="ow">&lt;-</span> <span class="kt">H</span><span class="o">.</span><span class="n">get</span>
       <span class="kr">_</span> <span class="ow">&lt;-</span> <span class="kt">H</span><span class="o">.</span><span class="n">query</span> <span class="n">unit</span>
         <span class="o">$</span> <span class="kt">Select</span><span class="o">.</span><span class="n">replaceItems</span>
         <span class="o">$</span> <span class="n">difference</span> <span class="p">(</span><span class="n">withDefault</span> <span class="kt">[]</span> <span class="n">st</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="n">st</span><span class="o">.</span><span class="n">selections</span>
       <span class="n">pure</span> <span class="n">next</span>

    <span class="kt">HandleSelect</span> <span class="n">message</span> <span class="n">next</span> <span class="ow">-&gt;</span> <span class="kr">case</span> <span class="n">message</span> <span class="kr">of</span>
      <span class="kt">Select</span><span class="o">.</span><span class="kt">Searched</span> <span class="n">string</span> <span class="ow">-&gt;</span> <span class="kr">do</span>
        <span class="n">st</span> <span class="ow">&lt;-</span> <span class="kt">H</span><span class="o">.</span><span class="n">get</span>

        <span class="kt">H</span><span class="o">.</span><span class="n">modify</span> <span class="kr">_</span> <span class="p">{</span> <span class="n">items</span> <span class="ow">=</span> <span class="kt">Loading</span> <span class="p">}</span>
        <span class="kr">_</span> <span class="ow">&lt;-</span> <span class="kt">H</span><span class="o">.</span><span class="n">query</span> <span class="n">unit</span> <span class="o">$</span> <span class="kt">Select</span><span class="o">.</span><span class="n">replaceItems</span> <span class="kt">[]</span>
        <span class="n">newItems</span> <span class="ow">&lt;-</span> <span class="kt">H</span><span class="o">.</span><span class="n">liftAff</span> <span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">fetchItems</span> <span class="n">string</span><span class="p">)</span>
        <span class="kt">H</span><span class="o">.</span><span class="n">modify</span> <span class="kr">_</span> <span class="p">{</span> <span class="n">items</span> <span class="ow">=</span> <span class="n">newItems</span> <span class="p">}</span>

        <span class="kr">_</span> <span class="ow">&lt;-</span> <span class="kt">H</span><span class="o">.</span><span class="n">query</span> <span class="n">unit</span>
          <span class="o">$</span> <span class="kt">Select</span><span class="o">.</span><span class="n">replaceItems</span>
          <span class="o">$</span> <span class="n">filter</span> <span class="p">(</span><span class="n">contains</span> <span class="p">(</span><span class="kt">Pattern</span> <span class="n">string</span><span class="p">))</span>
          <span class="o">$</span> <span class="n">difference</span> <span class="p">(</span><span class="n">withDefault</span> <span class="kt">[]</span> <span class="n">newItems</span><span class="p">)</span> <span class="n">st</span><span class="o">.</span><span class="n">selections</span>

        <span class="n">pure</span> <span class="n">next</span>

      <span class="kt">Select</span><span class="o">.</span><span class="kt">Selected</span> <span class="n">item</span> <span class="ow">-&gt;</span> <span class="kr">do</span>
        <span class="kt">H</span><span class="o">.</span><span class="n">modify</span> <span class="nf">\</span><span class="n">st</span> <span class="ow">-&gt;</span> <span class="n">st</span> <span class="p">{</span> <span class="n">selections</span> <span class="ow">=</span> <span class="n">item</span> <span class="kt">:</span> <span class="n">st</span><span class="o">.</span><span class="n">selections</span> <span class="p">}</span>
        <span class="n">st</span> <span class="ow">&lt;-</span> <span class="kt">H</span><span class="o">.</span><span class="n">get</span>
        <span class="kr">_</span> <span class="ow">&lt;-</span> <span class="kt">H</span><span class="o">.</span><span class="n">query</span> <span class="n">unit</span>
          <span class="o">$</span> <span class="kt">Select</span><span class="o">.</span><span class="n">replaceItems</span>
          <span class="o">$</span> <span class="n">difference</span> <span class="p">(</span><span class="n">withDefault</span> <span class="kt">[]</span> <span class="n">st</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="n">st</span><span class="o">.</span><span class="n">selections</span>
        <span class="kt">H</span><span class="o">.</span><span class="n">raise</span> <span class="o">$</span> <span class="kt">SelectionChange</span> <span class="n">st</span><span class="o">.</span><span class="n">selections</span>
        <span class="n">pure</span> <span class="n">next</span>

      <span class="kt">Select</span><span class="o">.</span><span class="kt">VisibilityChanged</span> <span class="n">vis</span> <span class="ow">-&gt;</span>
        <span class="n">pure</span> <span class="n">next</span>

      <span class="kt">Select</span><span class="o">.</span><span class="kt">Emit</span> <span class="n">query</span> <span class="ow">-&gt;</span> <span class="kr">do</span>
        <span class="n">eval</span> <span class="n">query</span>
        <span class="n">pure</span> <span class="n">next</span>
</pre></div>
</td></tr></table>
</details>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../dropdown/" title="Build a dropdown" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Build a dropdown
              </span>
            </div>
          </a>
        
        
          <a href="../../how-to/embed-parent-queries/" title="How to embed parent queries" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                How to embed parent queries
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 CitizenNet
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
        <script src="../../js/app.js"></script>
      
    
    
      
    
  </body>
</html>